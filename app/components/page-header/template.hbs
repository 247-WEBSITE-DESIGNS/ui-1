<nav class="clearfix" role="navigation">
  <button class="nav-logo logo-{{app.mode}} btn bg-transparent"><span class="sr-only">{{settings.appName}}</span></button>

  <ul class="nav-middle">
    {{#if (or isOss (gt projects.active.length 1))}}
      {{~page-header-environment
        currentPath=currentPath
        isOwner=isOwner
        switchProject="switchProject"
        switchNamespace="switchNamespace"
      ~}}
    {{/if}}

    {{#each navTree as |item|}}
      {{#if item.submenu.length}}
        {{! Has a submenu }}
        <li class="dropdown">
          {{#link-to-as-attrs
            item.route
            models=item.ctx
            queryParams=item.queryParams
            moreCurrentWhen=item.moreCurrentWhen
            activeParent=true
            class="dropdown-toggle"
            role="button"
            aria-haspopup="true"
            aria-expanded="false"
          }}
            {{maybe-t item.localizedLabel item.label}}
            <span class="icon icon-chevron-down"/>
          {{/link-to-as-attrs}}

          <ul class="dropdown-menu" data-dropdown-id={{item.id}}>
            {{#each item.submenu as |subitem|}}
              {{#if subitem.route}}
                <li>
                  {{#link-to-as-attrs
                    subitem.route
                    models=subitem.ctx
                    queryParams=subitem.queryParams
                    activeParent=true
                    moreCurrentWhen=subitem.moreCurrentWhen
                  }}
                    <i class="{{subitem.icon}}"/> {{maybe-t subitem.localizedLabel subitem.label}}
                  {{/link-to-as-attrs}}
                </li>
              {{else if subitem.divider}}
                <li class="divider"></li>
              {{else}}
                {{! Just a label }}
                <li class="dropdown-header">
                  <i class="{{subitem.icon}}"/> {{maybe-t subitem.localizedLabel subitem.label}}
                </li>
              {{/if}}
            {{/each}}
          </ul>
          {{#if item.showAlert}}
            {{#tooltip-element class="tooltip-warning" type='tooltip-warning' tooltipFor="showAlert"}}
              {{#link-to item.alertRoute data-toggle="tooltip" data-placement="bottom"}}!{{/link-to}}
            {{/tooltip-element}}
          {{/if}}
        </li>
      {{else if item.route}}
        {{! No submenu }}
        <li>
          {{#link-to-as-attrs
            item.route
            models=item.ctx
            queryParams=item.queryParams
            activeParent=true
            moreCurrentWhen=item.moreCurrentWhen
          }}
            {{maybe-t item.localizedLabel item.label}}
          {{/link-to-as-attrs}}
        </li>
      {{else}}
        {{! Just a label }}
        <li class="dropdown-header">
          {{maybe-t item.localizedLabel item.label}}
        </li>
      {{/if}}
    {{/each}}
  </ul>

  <div class="dropdown nav-user">
    <button class="btn bg-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
      {{#if accessEnabled}}
        {{identity-avatar link=false identity=access.identity}}
      {{else}}
        <div class="gh-avatar">
          <div class="gh-placeholder">
            <i class="icon icon-user"></i>
          </div>
        </div>
      {{/if}}
      <span class="sr-only">{{t 'nav.srToggleDropdown'}}</span>
      <i class="icon icon-chevron-down"></i>
    </button>

    <ul class="dropdown-menu dropdown-menu-right" data-dropdown-id="header-user-menu">
r     {{#if accessEnabled}}
        <li role="presentation" class="user-auth">
          {{identity-block avatar=false identity=access.identity}}
          {{#link-to "logout" class="user-logout"}}<i class="icon icon-logout"></i> {{t 'nav.user.logout'}}{{/link-to}}
        </li>
      {{/if}}

      <li><a href="#"></a></li>
      <li><a href="#">Something else here</a></li>
      <li role="separator" class="divider"></li>
      {{#link-to "logout" class="user-logout"}}<i class="icon icon-logout"></i> {{t 'nav.user.logout'}}{{/link-to}}
    </ul>
  </div>
</nav>

{{#if (and projects.current (not hosts.length))}}
  <div class="lacsso banner bg-info m-0 p-0">
    <div class="lacsso banner-icon" style="width: 68px;"><span class="icon icon-2x icon-alert"></span></div>
    <div class="lacsso banner-message">
      <p class="lacsso mt-15 mb-15">
        {{~t (if projects.current.isWindows 'nav.noHostsWindows.prefix' 'nav.noHosts.prefix') appName=settings.appName minVersion=settings.minDockerVersion~}}
        <a href="{{href-to 'hosts.new' projects.current.id}}">{{~t (if projects.current.isWindows 'nav.noHostsWindows.link' 'nav.noHosts.link') appName=settings.appName minVersion=settings.minDockerVersion~}}</a>
        {{~t (if projects.current.isWindows 'nav.noHostsWindows.suffix' 'nav.noHosts.suffix') appName=settings.appName minVersion=settings.minDockerVersion~}}
      </p>
    </div>
  </div>
{{/if}}
{{#if projects.current.isUpgrading}}
  <div class="banner bg-warning m-0 p-0">
    <div class="banner-icon" style="width: 68px;"><span class="icon icon-2x icon-spinner icon-spin"></span></div>
    <div class="banner-message">
      <p class="mt-15 mb-15">
        {{format-html-message 'projectUpgrade.banner'}}
      </p>
    </div>
  </div>
{{/if}}
